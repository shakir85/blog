<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="and how to hand over execution-flow from `ENTRYPOINT` to `CMD` like a boss"><title>Docker CMD and ENTRYPOINT differences</title>
<link rel=canonical href=https://demo.stack.jimmycai.com/p/docker-cmd-and-entrypoint-differences/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="Docker CMD and ENTRYPOINT differences"><meta property="og:description" content="and how to hand over execution-flow from `ENTRYPOINT` to `CMD` like a boss"><meta property="og:url" content="https://demo.stack.jimmycai.com/p/docker-cmd-and-entrypoint-differences/"><meta property="og:site_name" content="Shakir"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="grasping essentials"><meta property="article:published_time" content="2023-07-16T17:34:13-07:00"><meta property="article:modified_time" content="2023-07-16T17:34:13-07:00"><meta name=twitter:title content="Docker CMD and ENTRYPOINT differences"><meta name=twitter:description content="and how to hand over execution-flow from `ENTRYPOINT` to `CMD` like a boss"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu7eca515642ea01f2249538b3f83662be_6455_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ðŸ‘‹</span></figure><div class=site-meta><h1 class=site-name><a href=/>Shakir</a></h1><h2 class=site-description>Brief yet insightful posts covering DevOps, AWS, and the fascinating world of Linux</h2></div></header><ol class=social-menu><li><a href=https://github.com/shakir85 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://gitlab.com/homelabgroup target=_blank title=GitLab rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-gitlab" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M21 14l-9 7-9-7L6 3l3 7h6l3-7z"/></svg></a></li><li><a href=https://www.linkedin.com/in/almasaari/ target=_blank title=LinkedIn rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#the-way-entrypoint-and-cmd-work-together>The way <code>ENTRYPOINT</code> and <code>CMD</code> work together</a><ol><li><a href=#overriding-cmd>Overriding <code>CMD</code></a></li><li><a href=#overriding-entrypoint>Overriding <code>ENTRYPOINT</code></a></li></ol></li><li><a href=#handing-over-execution-flow-from-entrypoint-to-cmd>Handing over execution flow from <code>ENTRYPOINT</code> to <code>CMD</code></a><ol><li><a href=#enter-docker-enterypointsh>Enter &ldquo;docker-enterypoint.sh&rdquo;</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/linux/>linux
</a><a href=/categories/docker/>docker</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/docker-cmd-and-entrypoint-differences/>Docker CMD and ENTRYPOINT differences</a></h2><h3 class=article-subtitle>and how to hand over execution-flow from `ENTRYPOINT` to `CMD` like a boss</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 16, 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><p>In this post, I will demonstrate how <code>ENTRYPOINT</code> and <code>CMD</code> work together, their differences, and how to redirect the runtime execution flow from <code>ENTRYPOINT</code> to the <code>CMD</code> where the main application&rsquo;s command is executed.</p><h2 id=the-way-entrypoint-and-cmd-work-together>The way <code>ENTRYPOINT</code> and <code>CMD</code> work together</h2><p>In most cases, <code>CMD</code> and <code>ENTRYPOINT</code> instructions can be used interchangeably. Also, you do not have to use both of them together in every Dockerfile you develop. However, each instruction offers additional features that can help you control how you want to run your application. Before moving forward, let&rsquo;s quickly review what each instruction does:</p><ul><li><p><code>ENTRYPOINT</code> is like the &ldquo;main command&rdquo; or the starting point for your container. It&rsquo;s the default action the container takes when you run it. You might use <code>ENTRYPOINT</code> to start a web server or run a specific application.</p></li><li><p><code>CMD</code> can be used to provide additional arguments or options to the command specified in <code>ENTRYPOINT</code>. It&rsquo;s like saying, &ldquo;When you start the container using the <code>ENTRYPOINT</code> command, here are some extra args to pass to the executing app&rdquo;. It is often used to pass <em>default</em> arguments to <code>ENTRYPOINT</code>. Note that we said: &ldquo;default arguments&rdquo; which we&rsquo;ll explain what does that mean in a bit.</p></li></ul><p>So, <code>ENTRYPOINT</code> sets the main command of the container, and <code>CMD</code> provides default arguments to that command. Here is an example:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> ubuntu</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;echo&#34;</span><span class=p>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;Hello world&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>Running a container from this Dockerfile is similar to executing <code>echo "Hello world"</code> in the command line. The <code>echo</code> is the main app and <code>Hello world</code> is the argument. Similarly, in the Dockerfile above, the content of the <code>CMD</code> instruction is passed to the <code>ENTRYPOINT</code> as the default argument. when we build and run the container without arguments it will print &ldquo;Hello world&rdquo;:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>docker build -t <span class=nb>test</span> .
</span></span><span class=line><span class=cl>docker run <span class=nb>test</span>
</span></span></code></pre></td></tr></table></div></div><p>Output:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Hello world
</span></span></code></pre></td></tr></table></div></div><h3 id=overriding-cmd>Overriding <code>CMD</code></h3><p>To override the <code>CMD</code> that is defined in the Dockerfile (<em>default</em> argument), you just pass the argument(s) after the image name:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>docker run <span class=nb>test</span> <span class=s1>&#39;another hello world&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Output:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>another hello world
</span></span></code></pre></td></tr></table></div></div><p>This method also overrides the <code>CMD</code> whether it&rsquo;s used in combination with <code>ENTRYPOINT</code> instruction or not.</p><h3 id=overriding-entrypoint>Overriding <code>ENTRYPOINT</code></h3><p>Given this Dockerfile:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> ubuntu</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;echo&#34;</span><span class=p>,</span> <span class=s2>&#34;Hello world&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>When you have a Dockerfile with only an <code>ENTRYPOINT</code> (i.e. no <code>CMD</code>), you need to use the <code>--entrypoint</code> flag to override the entry-point command as the following:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># docker run --entrypoint &lt;command&gt; &lt;image&gt;</span>
</span></span><span class=line><span class=cl>docker run --entrypoint <span class=s1>&#39;printenv&#39;</span> <span class=nb>test</span>
</span></span></code></pre></td></tr></table></div></div><p>Output:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
</span></span><span class=line><span class=cl>HOSTNAME=7ffd59696373
</span></span><span class=line><span class=cl>HOME=/root
</span></span></code></pre></td></tr></table></div></div><p>If you try to supply a command at runtime without specifying the <code>--entrypoint</code> flag, Docker will treat the that command as additional arguments to the command specified in the <code>ENTRYPOINT</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>docker run <span class=nb>test</span> <span class=s1>&#39;printenv&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Output:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Hello world printenv
</span></span></code></pre></td></tr></table></div></div><p>This is similar to an entry-point in Dockerfile like this: <code>ENTRYPOINT ["echo", "Hello world", "printenv"]</code></p><h2 id=handing-over-execution-flow-from-entrypoint-to-cmd>Handing over execution flow from <code>ENTRYPOINT</code> to <code>CMD</code></h2><p>Consider the following Python Flask app:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:latest</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># ...</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># RUN &gt;&gt;&gt; install Python packages &amp; configs ...</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># COPY &gt;&gt;&gt; add files and executables</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># ...</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;uvicorn&#34;</span><span class=p>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;main:app&#34;</span><span class=p>,</span> <span class=s2>&#34;--host&#34;</span><span class=p>,</span> <span class=s2>&#34;0.0.0.0&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>The uvicorn command will be executed when the container runs, and the <code>CMD</code> instruction will provide the necessary arguments for the uvicorn server.</p><p>Usually, we need a way to include runtime configurations that our Flask app expects to be available in the run environment prior to executing the main application in the entry-point (e.g. <code>uvicorn</code>). These configurations could be starting a service, exporting environment variables, running a database migration script, or simply editing certain configuration files.</p><p>This type of commands (runtime commands) cannot be included in <code>RUN</code> stages, and it is an anti-pattern and honestly quite ugly to cram a lot of shell commands into the <code>ENTRYPOINT</code> and/or <code>CMD</code> sections.</p><h3 id=enter-docker-enterypointsh>Enter &ldquo;docker-enterypoint.sh&rdquo;</h3><p>When developing a Dockerfile, it is a common pattern to wrap various initialization commands within a shell script, conventionally named &lsquo;docker-entrypoint.sh&rsquo; or &rsquo;entrypoint.sh&rsquo; and execute it using an <code>ENTRYPOINT</code> instruction prior to running the main app. The purpose of this technique is to provide a flexible way of configuring the Docker container environment <em>at run time</em>.</p><p>Since <code>ENTRYPOINT</code> instruction provides run-time execution, we need to find a way to return the execution flow back the Dockerfile&rsquo;s <code>CMD</code> instruction to run the main application command.</p><p>To do so, simply add an <code>exec "@$"</code> statement at the very end of the shell script that is being executed by the <code>ENTRYPOINT</code> (i.e. &lsquo;docker-entrypoint.sh&rsquo;) file.</p><p>After adding all configuration scripts to &lsquo;docker-entrypoint.sh,&rsquo; we will modify the Dockerfile as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:latest</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># ...</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># RUN &gt;&gt;&gt; install Python packages &amp; configs ...</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># COPY &gt;&gt; add our app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># ....</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Copy the init script file to a directory in the PATH</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># You might need to `chmod +x` it too</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> docker-entrypoint.sh /usr/local/bin <span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;docker-entrypoint.sh&#34;</span><span class=p>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;uvicorn&#34;</span><span class=p>,</span> <span class=s2>&#34;main:app&#34;</span><span class=p>,</span> <span class=s2>&#34;--host&#34;</span><span class=p>,</span> <span class=s2>&#34;0.0.0.0&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>To visualize the process:</p><p><img src=/p/docker-cmd-and-entrypoint-differences/visual1.png width=1155 height=437 srcset="/p/docker-cmd-and-entrypoint-differences/visual1_hu22bb2e668f1b020c51f48902814d7093_127716_480x0_resize_box_3.png 480w, /p/docker-cmd-and-entrypoint-differences/visual1_hu22bb2e668f1b020c51f48902814d7093_127716_1024x0_resize_box_3.png 1024w" loading=lazy alt="&ldquo;Dockerfile example&rdquo;" class=gallery-image data-flex-grow=264 data-flex-basis=634px></p><p>When we run the container, Docker will execute the <code>ENTRYPOINT</code>, which contains the &ldquo;docker-entrypoint.sh&rdquo; script. Then, the <code>exec "$@"</code> command in the &ldquo;docker-entrypoint.sh&rdquo; script will, in a sense, return control to the <code>CMD</code>. To clarify, the exec part won&rsquo;t transfer execution flow; it just expands the arguments specified in the <code>CMD</code> instruction in a new process.</p><p>Let&rsquo;s break down what <code>exec "@$"</code> does:</p><ul><li><code>exec</code> is a Linux command used to replace the current process with a new process. In this case, it ensures that <code>"$@"</code> becomes the main process running in the container.</li><li><code>"$@"</code> expands to all the command-line arguments passed to the container when it starts (e.g. expanding the content of the <code>CMD</code> instruction). It preserves the exact arguments that were passed during container runtime. Also, you still can override the <code>CMD</code> by specifying args on the <code>docker run</code> command. Finally, note that you cannot place any commands in the &lsquo;docker-entrypoint.sh&rsquo; file after the exec &ldquo;$@&rdquo; line.</li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/grasping-essentials/>grasping essentials</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/docker-containers-process/><div class=article-details><h2 class=article-title>Docker containers process</h2></div></a></article><article><a href=/p/understanding-inodes/><div class=article-details><h2 class=article-title>Understanding inodes</h2></div></a></article><article><a href=/p/importing-functions-in-shell-scripting/><div class=article-details><h2 class=article-title>Importing functions in shell scripting</h2></div></a></article><article><a href=/p/control-the-default-gateway-in-a-dual-nic-host/><div class=article-details><h2 class=article-title>Control the default gateway In a dual NIC host</h2></div></a></article><article><a href=/p/a-practical-approach-for-using-docker-scratch-base-layer/><div class=article-details><h2 class=article-title>A practical approach for using Docker scratch base layer</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2024 Shakir</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>